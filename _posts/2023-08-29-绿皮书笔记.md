---
dlayout:    post
title:      Quantitative Finance Interviews
subtitle:   Book Review
date:       2023-8-29
author:     Kylin
header-img: img/quant.jpg
catalog: true
tags:
    - quant
---



[TOC]

### C1: Principles for Interview

- Board knowledge bases with "basic understanding"
- Prepare you for potential questions in interview
- Speak your mind, but with interviewer-concerned "specific" concepts. 
- make "reasonable" assumptions before solving problems



### C2: Brain Teasers

#### Screwy pirates



接下来，我们将会按照xxx的工作流介绍各个模块的designs. \ref{sec:model-partition} formulates xxx 在计算和储存差异的异构设备上进行模型分割。\ref{sec:granular-stages} 图示了通过构建uniform granular stages来平衡intra-stage和inter-stage的不平衡性，以构建高效的流水线。\ref{sec:recomputation-stages} 设计了使用recomputation策略的offloading scheduling，这个设计能够使得GPU-DRAM交换延迟兼容granular stage，进一步优化卸载延迟带来的inter-stage imbalance。\ref{sec:workload-stage} 介绍 xxx 进行 workload 调度和模型 remapping的算法设计，该部分能够对访问负载进行动态调度，并在系统服务效率最优性失效的时候实现非侵入的model remapping





$minimize \ \ \ \Sigma^N_{i=0} T_j + \frac{1}{\alpha_f}\cdot max^N_{i=0}T_j$

$I_{i,j}$ 是指示变量，表示是否将layer $i$ 制定到device $j$ 上



Input Variables:

$\alpha_f$: pre-defined 系数 for 衡量系统请求稳定程度的系数，由workload sheduling提供

$\alpha_r$: pre-defined request process pressure，由workload sheduling提供



System variables:

$L$: Number of the model's layers.

$N$: Number of GPUs.

$M$: Max size of micro-batch.

 

Objective varibles

$I_{i,j}$: 指示变量，layer $i$ 是否分配到 GPU $j$ 上.



Intermediate Variables:

$T_{j}$: Total latency on GPU $j$.

$G_i$: Memory capacity of GPU $j$.

$F_i$: Computation bandwidth of GPU $j$.

$B_i$:  GPU-DRAM communication bandwidth of GPU $j$. 

$C_{i,j}$: Communication latency between GPU $i$ and GPU $j$. 

$K$: Max size of a KV cache for a request.

$P_j$: Presrved size of model parameters in GPU $j$.

$O_i$: Floating Point Operations (FLOPs) of layer $i$.

$S_{i,j,k}$: 指示变量，layer $i$ 是否分配到 GPU $j$ 上, 而且layer $i+1$分配在GPU $k$ 上.

$A_j$: Expected Offloading Latency of layer $j$.



naturally

$\Sigma^N_{j=0} I_{i,j}=1$

$P_j \leq G_j$



Latency 约束

$$ T_j \geq \frac{\Sigma^L_{i=0} I_{i,j}O_i}{F_j}+\Sigma^L_{i=0}\Sigma^N_{k=0} C_{j,k}S_{i,j,k}+A_j$$

$$A_j\geq max(\frac{\alpha_rKM+P_{j}-G_j}{B_j},0) $$

$$\frac{G_j-P_j}{B_j}\leq \Sigma^L_{i=0}\Sigma^N_{k=0} (T_k-A_k)S_{i,k,j}$$





pipeline 顺序约束
$$
\begin{aligned}
& S_{i, j, k} \leq I_{i, j} \\
& S_{i, j, k} \leq I_{i+1, k} \\
& S_{i, j, k} \geq I_{i, j}+I_{i+1, k}-1
\end{aligned}
$$

$$
I_{i, j}+I_{l, j}-1 \leq I_{k, j}
$$

















